<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Coin Flip ğŸ‘‘ V 3.250 - Tam SÃ¼rÃ¼m</title>
    <meta name="description" content="GeliÅŸmiÅŸ olasÄ±lÄ±k ve yazÄ± tura simÃ¼lasyonu.">
    <style>
        /* =========================================
           1. CSS DEÄÄ°ÅKENLERÄ° & TEMA
           ========================================= */
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5b4bc4;
            --secondary: #a29bfe;
            --accent: #00b894;
            --danger: #ff7675;
            --warning: #fdcb6e;
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #2d3436;
            --text-muted: #636e72;
            --border-radius: 16px;
            --shadow-sm: 0 4px 6px rgba(0,0,0,0.05);
            --shadow-md: 0 10px 20px rgba(0,0,0,0.08);
            --font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --coin-size: 140px;
            --flip-duration: 2s; /* VarsayÄ±lan hÄ±z */
        }

        body.dark-mode {
            --primary: #8980f4;
            --primary-dark: #6c5ce7;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --secondary: #404040;
        }
        
        /* HÄ±z yÃ¼kseltmesi iÃ§in Ã¶zel CSS deÄŸiÅŸkeni */
        .fast-flip {
            --flip-duration: 0.5s !important; 
        }

        /* =========================================
           2. GENEL YAPI & RESET
           ========================================= */
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: var(--font-family);
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden;
        }

        /* Header */
        .app-header {
            width: 100%; padding: 15px 20px;
            background: var(--card-bg);
            box-shadow: var(--shadow-sm);
            display: flex; justify-content: space-between; align-items: center;
            position: fixed; top: 0; left: 0; z-index: 100;
            transition: background-color 0.3s;
        }
        .app-logo { font-weight: 800; font-size: 1.2rem; color: var(--primary); letter-spacing: -0.5px; }
        .header-controls { display: flex; gap: 10px; align-items: center; }
        .icon-btn { background: none; border: none; font-size: 1.4rem; cursor: pointer; color: var(--text-main); transition: transform 0.2s; }
        .icon-btn:active { transform: scale(0.9); }
        
        /* Currency Display */
        #currency-display {
            background: var(--warning); color: var(--text-main); padding: 5px 12px;
            border-radius: 20px; font-weight: 700; font-size: 0.9rem;
            display: flex; align-items: center; gap: 5px;
        }

        /* Main Content */
        .main-container {
            margin-top: 80px; width: 95%; max-width: 480px;
            display: flex; flex-direction: column; align-items: center;
            padding-bottom: 100px;
        }

        /* =========================================
           3. OYUN ALANI (COIN)
           ========================================= */
        .coin-stage {
            perspective: 1000px;
            width: var(--coin-size); height: var(--coin-size);
            margin: 40px 0;
            position: relative;
        }
        
        #coin {
            width: 100%; height: 100%;
            position: relative;
            transform-style: preserve-3d;
            border-radius: 50%;
            box-shadow: 
                inset 0 0 20px rgba(255,255,255,0.5),
                0 15px 35px rgba(0,0,0,0.2);
            display: flex; align-items: center; justify-content: center;
            font-size: 4rem;
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            border: 8px solid #fff;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: border-radius 0.3s, background 0.3s;
        }
        
        body.dark-mode #coin { border-color: #333; }

        .is-flipping { animation: flip3d var(--flip-duration) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        
        @keyframes flip3d {
            0% { transform: rotateY(0) scale(1); }
            50% { transform: rotateY(900deg) scale(1.4); }
            100% { transform: rotateY(1800deg) scale(1); }
        }

        #result-text {
            font-size: 1.5rem; font-weight: 700;
            color: var(--primary); margin-bottom: 20px;
            min-height: 1.5em; text-align: center;
            transition: opacity 0.3s, color 0.3s;
        }
        
        .coin-message {
             font-size: 0.9rem; color: var(--text-main); font-weight: 600; margin-top: 10px;
             /* ÅANS ETKÄ°NLÄ°ÄÄ° iÃ§in eklendi */
             padding: 5px 10px; border-radius: 8px;
        }
        
        /* ÅANS ETKÄ°NLÄ°ÄÄ° MESAJI */
        .coin-message[style*="background-color: var(--accent)"] {
            background-color: var(--accent);
            color: var(--card-bg) !important;
            animation: pulse 1s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(1); opacity: 0.9; }
            to { transform: scale(1.03); opacity: 1; }
        }

        /* =========================================
           4. KONTROLLER & DASHBOARD
           ========================================= */
        .dashboard-card {
            background: var(--card-bg);
            width: 100%;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }

        .control-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 14px; border: none; border-radius: 12px;
            font-weight: 600; font-size: 1rem; cursor: pointer;
            transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        
        .btn-primary { background-color: var(--primary); color: #fff; box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3); }
        .btn-primary:active { transform: translateY(2px); box-shadow: none; }
        .btn-primary:disabled { background-color: #a0a0a0; cursor: not-allowed; box-shadow: none; }
        
        .btn-secondary { background-color: var(--bg-color); color: var(--text-main); }
        .btn-secondary:hover { background-color: #e0e0e0; }
        .dark-mode .btn-secondary { background-color: var(--secondary); color: var(--text-main); }
        .dark-mode .btn-secondary:hover { background-color: #555; }

        .auto-section {
            display: flex; gap: 10px; align-items: center;
            background: var(--bg-color); padding: 10px; border-radius: 12px;
        }
        
        .select-box {
            padding: 10px; border-radius: 8px; border: 1px solid #ccc;
            background: var(--card-bg); color: var(--text-main); flex-grow: 1;
        }
        .dark-mode .select-box { background: #333; border-color: #555; }

        /* =========================================
           5. MAÄAZA & KOZMETÄ°KLER
           ========================================= */
        .shop-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;
        }
        .shop-item {
            background: var(--bg-color); padding: 15px; border-radius: var(--border-radius);
            text-align: center; border: 2px solid transparent; transition: all 0.2s;
        }
        .shop-item.equipped { border-color: var(--accent); background: #e8f8f5; }
        .dark-mode .shop-item.equipped { background: #1e3a30; }
        .shop-item-icon { font-size: 2.5rem; display: block; margin-bottom: 5px; }
        .shop-price { color: var(--warning); font-weight: 700; margin-top: 5px; }

        /* YÃ¼kseltmeler iÃ§in farklÄ± stil */
        .upgrade-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            margin-bottom: 15px;
            border-left: 5px solid var(--accent);
        }
        .upgrade-info {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 10px;
        }
        .upgrade-level { font-weight: 700; color: var(--primary-dark); }
        .upgrade-cost { font-weight: 700; color: var(--warning); }
        .upgrade-desc { font-size: 0.9rem; color: var(--text-muted); }


        /* =========================================
           6. MODALLER
           ========================================= */
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(3px);
            z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s;
            display: flex; justify-content: center; align-items: flex-end;
        }
        .modal-backdrop.open { opacity: 1; pointer-events: all; }
        
        .modal-content {
            background: var(--card-bg); width: 100%; max-width: 500px;
            border-radius: 24px 24px 0 0; padding: 30px;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            max-height: 85vh; overflow-y: auto;
        }
        .modal-backdrop.open .modal-content { transform: translateY(0); }

        .menu-list { list-style: none; padding: 0; margin: 0; }
        .menu-list li {
            padding: 15px; border-bottom: 1px solid var(--bg-color);
            cursor: pointer; display: flex; align-items: center; gap: 15px;
            font-size: 1.1rem;
        }
        .dark-mode .menu-list li { border-color: #333; }
        .menu-list li:last-child { border-bottom: none; }
        .menu-list li:active { background-color: var(--bg-color); }

        /* Achievements Grid */
        .achievements-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px;
        }
        .achievement-item {
            background: var(--bg-color); border-radius: 10px; padding: 10px;
            text-align: center; opacity: 0.4; filter: grayscale(100%); transition: all 0.3s;
            cursor: pointer; /* TÄ±klanabilir yaptÄ±k */
        }
        .achievement-item.unlocked { opacity: 1; filter: grayscale(0%); background: #e8f8f5; border: 1px solid var(--accent); }
        .dark-mode .achievement-item.unlocked { background: #1e3a30; }
        .ach-icon { font-size: 1.5rem; display: block; margin-bottom: 5px; }

        /* BaÅŸarÄ±m AÃ§Ä±klama Modal */
        #ach-info-modal .modal-content {
            max-width: 350px;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20%;
        }
        #ach-info-modal.open { align-items: center; } /* Ortalamak iÃ§in */
        #ach-info-modal h3 { margin-top: 0; color: var(--primary); }
        #ach-info-modal p { font-size: 1rem; color: var(--text-main); }
        #ach-reward { font-weight: 700; color: var(--warning); margin-top: 10px; }


        /* Input Groups */
        .input-group { margin-bottom: 15px; display: flex; gap: 10px; align-items: center; }
        .input-text { flex: 1; padding: 12px; border: 1px solid #ccc; border-radius: 8px; background: var(--bg-color); color: var(--text-main); }
        .dark-mode .input-text { background: #333; border-color: #555; }
        .input-color { width: 40px; height: 40px; border: none; background: none; cursor: pointer; }
        .input-emoji { width: 50px; text-align: center; }

        /* KÃ¼Ã§Ã¼k ekranlar iÃ§in footer ayarÄ± */
        .version-footer {
            position: fixed; bottom: 10px; left: 0; width: 100%; text-align: center;
            font-size: 0.75rem; color: var(--text-muted); z-index: 90;
        }
        
        /* Stat Row (Analist ModalÄ± iÃ§in) */
        .stat-row {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 10px; font-size: 0.95rem;
        }
        .stat-bar-wrapper { flex-grow: 1; height: 10px; background: var(--bg-color); border-radius: 5px; margin: 0 10px; overflow: hidden; }
        .dark-mode .stat-bar-wrapper { background: #333; }
        .stat-bar { height: 100%; border-radius: 5px; transition: width 0.5s ease; }
    </style>
</head>
<body id="game-body">

    <div id="audio-engine-status" style="display:none;"></div>

    <header class="app-header">
        <div class="app-logo">ğŸ‘‘ CoinFlip Ultimate</div>
        <div class="header-controls">
            <span id="currency-display">ğŸ’° 0</span>
            <button class="icon-btn" onclick="Game.ui.openShopModal()">ğŸ›ï¸</button>
            <button class="icon-btn" onclick="Game.ui.openAnalystModal()">ğŸ§ </button>
            <div id="streak-badge" class="streak-badge" style="display: none;">ğŸ”¥ 0</div>
            <button class="icon-btn" onclick="Game.ui.toggleMenu()">â˜°</button>
        </div>
    </header>

    <div class="main-container">
        
        <div class="coin-stage">
            <div id="coin">?</div>
        </div>

        <div id="result-text">Hadi BaÅŸlayalÄ±m!</div>
        <div id="flip-message" class="coin-message" style="display:none;">+1 Jeton KazanÄ±ldÄ±!</div>

        <div class="dashboard-card">
            <div class="control-grid">
                <button id="btn-flip" class="btn btn-primary" onclick="Game.logic.flip()">
                    <span>ğŸ²</span> ParayÄ± At
                </button>
                <button id="btn-reset" class="btn btn-secondary" onclick="Game.logic.resetStats()">
                    <span>ğŸ”„</span> SÄ±fÄ±rla
                </button>
            </div>
            
            <div class="auto-section">
                <select id="auto-limit" class="select-box">
                    <option value="10">10 Kez</option>
                    <option value="50">50 Kez</option>
                    <option value="100">100 Kez</option>
                    <option value="999999">SÄ±nÄ±rsÄ±z</option>
                </select>
                <button id="btn-auto" class="btn btn-secondary" onclick="Game.logic.toggleAuto()">
                    ğŸš€ Otomatik
                </button>
            </div>
        </div>

        <div class="dashboard-card">
            <h3 style="margin-top:0;">ğŸ“Š Ä°statistikler (<span id="mode-name-display">Normal</span>)</h3>
            <div id="stats-container">
                </div>
            <div style="margin-top:15px; font-size:0.9rem; color:var(--text-muted); display:flex; justify-content:space-between;">
                <span>Toplam: <b id="total-flips">0</b></span>
                <span>Rekor Seri: <b id="best-streak">0</b></span>
            </div>
        </div>

        <div class="dashboard-card">
            <h3 style="margin-top:0; font-size:1rem;">ğŸ† BaÅŸarÄ±mlar</h3>
            <div class="achievements-grid" id="achievements-list">
                </div>
        </div>

    </div>

    <div class="version-footer">V 3.250 - Tam Ã‡alÄ±ÅŸÄ±r SÃ¼rÃ¼m | AÄŸÄ±rlÄ±klÄ± ve Ã–zel Modlar Aktif</div>
    <canvas id="confetti-canvas"></canvas>

    <div id="main-menu-modal" class="modal-backdrop" onclick="if(event.target===this) Game.ui.toggleMenu()">
        <div class="modal-content">
            <h2 style="margin-top:0;">Ayarlar & Modlar</h2>
            <ul class="menu-list">
                <li onclick="Game.logic.setMode('NORMAL')">ğŸ¯ Normal Mod (YazÄ±/Tura)</li>
                <li onclick="Game.ui.openWeightedModal()">âš–ï¸ AÄŸÄ±rlÄ±klÄ± Mod (AyarlÄ± OlasÄ±lÄ±k)</li>
                <li onclick="Game.logic.setMode('RPS')">âœŠ TaÅŸ-KaÄŸÄ±t-Makas Modu</li>
                <li onclick="Game.logic.setMode('SIMPLE')">â“ Basit Mod (Evet/HayÄ±r)</li>
                <li onclick="Game.logic.setMode('DICE')">ğŸ² Zar Modu (1-6)</li>
                <li onclick="Game.logic.setMode('CATEGORY')">ğŸ“š 12 Kategori Modu (YENÄ°)</li>
                <li onclick="Game.ui.openCustomModal()">âœï¸ Ã–zel Mod OluÅŸtur</li>
                <hr style="width:100%; border-color: var(--bg-color);">
                <li onclick="Game.ui.toggleTheme()">ğŸŒ“ Tema DeÄŸiÅŸtir (Koyu/AÃ§Ä±k)</li>
                <li onclick="Game.data.exportData()">ğŸ’¾ Verileri Kaydet (Ä°ndir)</li>
                <li onclick="document.getElementById('import-file').click()">ğŸ“‚ Verileri YÃ¼kle</li>
                <input type="file" id="import-file" style="display:none" onchange="Game.data.importData(this)">
            </ul>
            <button class="btn btn-secondary" style="width:100%; margin-top:20px;" onclick="Game.ui.toggleMenu()">Kapat</button>
        </div>
    </div>

    <div id="shop-modal" class="modal-backdrop" onclick="if(event.target===this) document.getElementById('shop-modal').classList.remove('open')">
        <div class="modal-content">
            <h2>ğŸ›ï¸ MaÄŸaza</h2>
            <p id="shop-currency-display" style="font-weight: 700; color: var(--primary);">Mevcut Jeton: ğŸ’° 0</p>
            
            <h3 style="margin-top: 20px;">ğŸ’° KalÄ±cÄ± YÃ¼kseltmeler</h3>
            <div id="upgrade-section">
                 </div>
            
            <h3 style="margin-top: 20px;">ğŸ¨ Kozmetik ÃœrÃ¼nler</h3>
            <div id="shop-items-grid" class="shop-grid">
                </div>
            <button class="btn btn-secondary" style="width:100%; margin-top:20px;" onclick="document.getElementById('shop-modal').classList.remove('open')">Kapat</button>
        </div>
    </div>

    <div id="analyst-modal" class="modal-backdrop" onclick="if(event.target===this) document.getElementById('analyst-modal').classList.remove('open')">
        <div class="modal-content">
            <h2>ğŸ§  Analiz Merkezi</h2>
            <p style="font-size:0.9rem; color:var(--text-muted);">GeliÅŸmiÅŸ istatistikler ve eÄŸlencelik tahminler.</p>
            
            <div class="dashboard-card" style="margin-bottom: 10px; padding: 15px;">
                <h4 style="margin-top:0;">Toplam BaÅŸarÄ±mlar</h4>
                <div id="analyst-long-stats"></div>
            </div>

            <div class="dashboard-card" style="padding: 15px;">
                <h4 style="margin-top:0;">OlasÄ±lÄ±k AsistanÄ± (EÄŸlence AmaÃ§lÄ±)</h4>
                <p id="analyst-prediction" style="font-size: 1.1rem; font-weight: 600; min-height: 1.5em;"></p>
                <p style="font-size: 0.85rem; color: var(--danger);">*Bu tahminler sadece istatistiksel sapmalara dayanÄ±r, gerÃ§ek sonuÃ§larÄ± garanti etmez.</p>
            </div>
            
            <button class="btn btn-secondary" style="width:100%; margin-top:20px;" onclick="document.getElementById('analyst-modal').classList.remove('open')">Kapat</button>
        </div>
    </div>

    <div id="custom-modal" class="modal-backdrop" onclick="if(event.target===this) document.getElementById('custom-modal').classList.remove('open')">
        <div class="modal-content">
            <h2>âœï¸ Ã–zelleÅŸtir</h2>
            <p style="font-size:0.9rem; color:var(--text-muted)">Min 2, Maks 5 sonuÃ§. Sadece 1 Emoji. Her sonuÃ§ eÅŸit aÄŸÄ±rlÄ±klÄ± olur.</p>
            <div id="custom-inputs"></div>
            <button class="btn btn-secondary" style="width:100%; margin:10px 0;" onclick="Game.ui.addCustomInput()">+ Ekle</button>
            <div class="control-grid">
                <button class="btn btn-primary" onclick="Game.logic.saveCustomMode()">Kaydet ve BaÅŸlat</button>
                <button class="btn btn-secondary" onclick="document.getElementById('custom-modal').classList.remove('open')">Ä°ptal</button>
            </div>
        </div>
    </div>
    
    <div id="weighted-modal" class="modal-backdrop" onclick="if(event.target===this) document.getElementById('weighted-modal').classList.remove('open')">
        <div class="modal-content">
            <h2>âš–ï¸ AÄŸÄ±rlÄ±klÄ± OlasÄ±lÄ±k AyarÄ±</h2>
            <p style="font-size:0.9rem; color:var(--text-muted)">Her sonucun yÃ¼zdesini belirleyin. Toplam %100 olmalÄ±dÄ±r (YazÄ±/Tura iÃ§in).</p>
            
            <div id="weighted-inputs"></div>
            <div style="font-weight: bold; margin-top: 10px;">Toplam: <span id="weighted-total">0%</span></div>
            <div id="weighted-error" style="color: var(--danger); font-size: 0.9rem; min-height: 1.5em;"></div>

            <div class="control-grid">
                <button class="btn btn-primary" onclick="Game.logic.saveWeightedConfig()">AyarlarÄ± Kaydet ve BaÅŸlat</button>
                <button class="btn btn-secondary" onclick="document.getElementById('weighted-modal').classList.remove('open')">Ä°ptal</button>
            </div>
        </div>
    </div>

    <div id="ach-info-modal" class="modal-backdrop" onclick="if(event.target===this) document.getElementById('ach-info-modal').classList.remove('open')">
        <div class="modal-content">
            <h3 id="ach-title"></h3>
            <p id="ach-desc"></p>
            <p id="ach-reward"></p>
            <p id="ach-status"></p>
            <button class="btn btn-primary" style="width:100%; margin-top:10px;" onclick="document.getElementById('ach-info-modal').classList.remove('open')">Tamam</button>
        </div>
    </div>

    <script>
        /**
         * ====================================================================
         * GAME ENGINE V 3.250 - TAM Ã‡ALIÅIR SÃœRÃœM
         * ====================================================================
         */
        const Game = {
            state: {
                mode: 'NORMAL',
                outcomes: [],
                total: 0,
                streak: 0,
                bestStreak: 0,
                lastId: null,
                isAuto: false,
                autoLimit: 0,
                autoCount: 0,
                history: [],
                unlockedAchievements: [],
                weightedConfig: [], 
                customOutcomes: [],
                currency: 100, 
                inventory: ['default'],
                activeSkin: 'default',
                flipBonusLevel: 1, 
                flipBonus: 1, 
                flipSpeedLevel: 1, 
                flipDuration: 2,   
                luckyBonusLevel: 1, 
                longTermStats: { 
                    totalCurrencyEarned: 0, 
                    totalFlipWins: 0, 
                    totalFlipLosses: 0, 
                    modePlays: {},
                    luckyFlipsWon: 0,
                    auto100Completed: false 
                }
            },
            
            defaults: {
                NORMAL: [
                    { id: 'n1', name: 'YazÄ±', emoji: 'âœï¸', color: '#ff7675', count: 0, weight: 50 },
                    { id: 'n2', name: 'Tura', emoji: 'ğŸ‘‘', color: '#00b894', count: 0, weight: 50 }
                ],
                SIMPLE: [
                    { id: 's1', name: 'Evet', emoji: 'âœ…', color: '#2ecc71', count: 0, weight: 50 },
                    { id: 's2', name: 'HayÄ±r', emoji: 'âŒ', color: '#e74c3c', count: 0, weight: 50 }
                ],
                DICE: [
                    { id: 'd1', name: '1', emoji: 'âš€', color: '#3498db', count: 0, weight: 16.66 },
                    { id: 'd2', name: '2', emoji: 'âš', color: '#3498db', count: 0, weight: 16.66 },
                    { id: 'd3', name: '3', emoji: 'âš‚', color: '#3498db', count: 0, weight: 16.66 },
                    { id: 'd4', name: '4', emoji: 'âšƒ', color: '#3498db', count: 0, weight: 16.66 },
                    { id: 'd5', name: '5', emoji: 'âš„', color: '#3498db', count: 0, weight: 16.66 },
                    { id: 'd6', name: '6', emoji: 'âš…', color: '#3498db', count: 0, weight: 16.66 } 
                ],
                RPS: [
                    { id: 'r1', name: 'TaÅŸ', emoji: 'âœŠ', color: '#95a5a6', count: 0, weight: 33.33 },
                    { id: 'r2', name: 'KaÄŸÄ±t', emoji: 'âœ‹', color: '#f1c40f', count: 0, weight: 33.33 },
                    { id: 'r3', name: 'Makas', emoji: 'âœŒï¸', color: '#3498db', count: 0, weight: 33.33 }
                ],
                CATEGORY: [ 
                    { id: 'cat1', name: 'Hayvan', emoji: 'ğŸ¾', color: '#f9ca24', count: 0, weight: 8.33 },
                    { id: 'cat2', name: 'Meyve', emoji: 'ğŸ', color: '#eb4d4b', count: 0, weight: 8.33 },
                    { id: 'cat3', name: 'TaÅŸÄ±t', emoji: 'ğŸš—', color: '#0fbcf9', count: 0, weight: 8.33 },
                    { id: 'cat4', name: 'Spor', emoji: 'âš½', color: '#1dd1a1', count: 0, weight: 8.33 },
                    { id: 'cat5', name: 'Renk', emoji: 'ğŸŒˆ', color: '#9d32d7', count: 0, weight: 8.33 },
                    { id: 'cat6', name: 'Ãœlke', emoji: 'ğŸ—ºï¸', color: '#f78c00', count: 0, weight: 8.33 },
                    { id: 'cat7', name: 'Hava', emoji: 'â˜ï¸', color: '#54a0ff', count: 0, weight: 8.33 },
                    { id: 'cat8', name: 'Gezegen', emoji: 'ğŸª', color: '#9c88ff', count: 0, weight: 8.33 },
                    { id: 'cat9', name: 'MÃ¼zik', emoji: 'ğŸ¶', color: '#ff6b81', count: 0, weight: 8.33 },
                    { id: 'cat10', name: 'Yemek', emoji: 'ğŸ”', color: '#2ecc71', count: 0, weight: 8.33 },
                    { id: 'cat11', name: 'Para', emoji: 'ğŸ’µ', color: '#f1c40f', count: 0, weight: 8.33 },
                    { id: 'cat12', name: 'Åans', emoji: 'ğŸ€', color: '#38ada9', count: 0, weight: 8.33 }
                ],
                CUSTOM: [] // KullanÄ±cÄ± tarafÄ±ndan doldurulur
            },

            // Market YÃ¼kseltmeleri
            upgrades: {
                flipBonus: {
                    name: "ğŸ’° Jeton Ã‡arpanÄ±",
                    icon: "âœ¨",
                    baseCost: 50,
                    costMultiplier: 1.5,
                    maxLevel: 10,
                    effect: (level) => level, 
                    desc: (level) => `AtÄ±ÅŸ baÅŸÄ±na kazanÄ±lan jeton miktarÄ±nÄ± x${level} yapar.`
                },
                flipSpeed: { 
                    name: "âš¡ AtÄ±ÅŸ HÄ±zÄ±",
                    icon: "ğŸ’¨",
                    baseCost: 100,
                    costMultiplier: 2,
                    maxLevel: 4,
                    effect: (level) => {
                         const speeds = { 1: 2.0, 2: 1.5, 3: 1.0, 4: 0.5 };
                         return speeds[level];
                    }, 
                    desc: (level) => {
                        const nextSpeed = Game.upgrades.flipSpeed.effect(level + 1);
                        return `DÃ¶nÃ¼ÅŸ sÃ¼resini ${level} seviyesinde ${Game.upgrades.flipSpeed.effect(level)} saniyeye dÃ¼ÅŸÃ¼rÃ¼r. (Sonraki: ${nextSpeed || 'MAX'}s)`;
                    }
                },
                
                luckyBonus: {
                    name: "ğŸ€ Åans EtkinliÄŸi Jetonu",
                    icon: "ğŸŒŸ",
                    baseCost: 200,
                    costMultiplier: 1.8,
                    maxLevel: 10,
                    effect: (level) => 10 + (level * 10 * level), 
                    desc: (level) => `Åans EtkinliÄŸi (Lucky Flip) ile kazanÄ±lan ekstra jeton miktarÄ±nÄ± artÄ±rÄ±r. Mevcut Ekstra: ğŸ’° ${Game.upgrades.luckyBonus.effect(level)}`
                }
            },

            skins: {
                'default': { name: 'VarsayÄ±lan', emoji: 'ğŸª™', background: 'linear-gradient(135deg, #f1c40f 0%, #f39c12 100%)', color: '#fff', price: 0, unlocked: true },
                'gold': { name: 'AltÄ±n', emoji: 'ğŸ†', background: 'linear-gradient(135deg, #ffd700 0%, #daa520 100%)', color: '#333', price: 200, unlocked: false },
                'space': { name: 'Uzay TaÅŸÄ±', emoji: 'ğŸ‘½', background: 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)', color: '#fff', price: 500, unlocked: false },
                'ruby': { name: 'Yakut Zar', emoji: 'â™¦ï¸', background: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)', color: '#fff', price: 1000, unlocked: false },
                'matrix': { name: 'Matrix', emoji: 'ğŸ”¢', background: 'linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)', color: '#000', price: 1500, unlocked: false },
                'ocean': { name: 'Okyanus', emoji: 'ğŸŒŠ', background: 'linear-gradient(135deg, #4dc3ff 0%, #3a8fe9 100%)', color: '#fff', price: 2500, unlocked: false },
                'lava': { name: 'Lav', emoji: 'ğŸŒ‹', background: 'linear-gradient(135deg, #ff4500 0%, #ff8c00 100%)', color: '#333', price: 4000, unlocked: false },
                'diamond': { name: 'Elmas', emoji: 'ğŸ’', background: 'linear-gradient(135deg, #d3d3d3 0%, #e0ffff 100%)', color: '#333', price: 5000, unlocked: false },
                'nightsky': { name: 'Gece GÃ¶kyÃ¼zÃ¼', emoji: 'ğŸŒŒ', background: 'linear-gradient(135deg, #1e002a 0%, #4a0050 100%)', color: '#a29bfe', price: 7500, unlocked: false },
                'hologram': { name: 'Hologram', emoji: 'âœ¨', background: 'linear-gradient(135deg, #e3f2ff 0%, #c7e0ff 100%)', color: '#1e1e1e', price: 10000, unlocked: false },
                
                'fireball': { name: 'AteÅŸ Topu', emoji: 'ğŸ’¥', background: 'linear-gradient(135deg, #ff5e00 0%, #e80e00 100%)', color: '#fff', price: 12000, unlocked: false },
                'neon': { name: 'Neon IÅŸÄ±k', emoji: 'ğŸ’¡', background: 'linear-gradient(135deg, #00f260 0%, #0575e6 100%)', color: '#fff', price: 15000, unlocked: false },
                'cyberpunk': { name: 'Siber', emoji: 'ğŸ¤–', background: 'linear-gradient(135deg, #ff00c8 0%, #00ffd5 100%)', color: '#1e1e1e', price: 20000, unlocked: false }
            },

            // BaÅŸarÄ±mlar (Ã–dÃ¼ller dahil)
            achievements: [
                { id: 'a1_first_flip', icon: 'ğŸ£', title: 'Ä°lk AdÄ±m', desc: 'Ä°lk atÄ±ÅŸÄ±nÄ±zÄ± yapÄ±n.', check: (s) => s.total >= 1, reward: 10 },
                { id: 'a2_ten_flips', icon: 'ğŸ”Ÿ', title: 'Onluk', desc: '10 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 10, reward: 25 },
                { id: 'a3_century', icon: 'ğŸ’¯', title: 'AsÄ±rlÄ±k', desc: '100 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 100, reward: 100 },
                { id: 'a4_millennium', icon: 'ğŸ”¥', title: 'Bin AtÄ±ÅŸÃ§Ä±', desc: '1.000 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 1000, reward: 500 },
                { id: 'a5_master', icon: 'ğŸ‘‘', title: 'Usta', desc: '5.000 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 5000, reward: 1000 },
                
                { id: 'a6_streak_3', icon: 'âœ¨', title: 'Seri 3', desc: 'AynÄ± sonuca 3 kez Ã¼st Ã¼ste ulaÅŸÄ±n.', check: (s) => s.bestStreak >= 3, reward: 50 },
                { id: 'a7_streak_5', icon: 'ğŸ”¥', title: 'Seri 5', desc: 'AynÄ± sonuca 5 kez Ã¼st Ã¼ste ulaÅŸÄ±n.', check: (s) => s.bestStreak >= 5, reward: 150 },
                { id: 'a8_streak_10', icon: 'ğŸ§¨', title: 'Zincirleme', desc: 'AynÄ± sonuca 10 kez Ã¼st Ã¼ste ulaÅŸÄ±n.', check: (s) => s.bestStreak >= 10, reward: 500 },
                
                { id: 'a9_weighted_test', icon: 'âš–ï¸', title: 'OlasÄ±lÄ±kÃ§Ä±', desc: 'AÄŸÄ±rlÄ±klÄ± modu kullanÄ±n.', check: (s) => s.longTermStats.modePlays && s.longTermStats.modePlays['WEIGHTED'] >= 10, reward: 50 },
                { id: 'a10_custom_mode', icon: 'âœï¸', title: 'YaratÄ±cÄ±', desc: 'Ã–zel mod oluÅŸturun ve 10 kez oynayÄ±n.', check: (s) => s.longTermStats.modePlays && s.longTermStats.modePlays['CUSTOM'] >= 10, reward: 50 },
                
                { id: 'a11_rich_boy', icon: 'ğŸ’°', title: 'Cebinde Para Var', desc: '2.000 Jeton biriktirin (anlÄ±k jeton).', check: (s) => s.currency >= 2000, reward: 200 },
                { id: 'a12_tycoon', icon: 'ğŸ’', title: 'Zengin', desc: '10.000 Jeton biriktirin (anlÄ±k jeton).', check: (s) => s.currency >= 10000, reward: 1000 },
                { id: 'a13_cosmetics', icon: 'ğŸ›ï¸', title: 'Giyin KuÅŸan', desc: 'Bir kozmetik Ã¼rÃ¼n satÄ±n alÄ±n.', check: (s) => Game.state.inventory.length > 1, reward: 50 },
                
                { id: 'a14_max_bonus_2', icon: 'ğŸŒŸ', title: 'Bonus 2x', desc: 'Jeton Ã‡arpanÄ±nÄ± 2. seviyeye yÃ¼kseltin.', check: (s) => s.flipBonusLevel >= 2, reward: 100 },
                { id: 'a15_max_bonus_5', icon: 'âš¡', title: 'Bonus 5x', desc: 'Jeton Ã‡arpanÄ±nÄ± 5. seviyeye yÃ¼kseltin.', check: (s) => s.flipBonusLevel >= 5, reward: 500 },
                
                { id: 'a16_mode_dice', icon: 'ğŸ²', title: 'Zar Tutkunu', desc: 'Zar Modunda 100 kez atÄ±ÅŸ yapÄ±n.', check: (s) => s.longTermStats.modePlays && s.longTermStats.modePlays['DICE'] >= 100, reward: 200 },
                { id: 'a17_mode_rps', icon: 'âœŠ', title: 'TaÅŸÃ§Ä±', desc: 'TaÅŸ-KaÄŸÄ±t-Makas Modunda 100 kez atÄ±ÅŸ yapÄ±n.', check: (s) => s.longTermStats.modePlays && s.longTermStats.modePlays['RPS'] >= 100, reward: 200 },

                { id: 'a18_all_skins', icon: 'ğŸŒˆ', title: 'Koleksiyoncu', desc: 'TÃ¼m kozmetik Ã¼rÃ¼nleri toplayÄ±n.', check: (s) => s.inventory.length === Object.keys(Game.skins).length, reward: 5000 },

                { id: 'a19_auto_100', icon: 'ğŸ¤–', title: 'Otomatik Pilot', desc: 'Tek seferde 100 atÄ±ÅŸ yapÄ±n.', check: (s) => s.longTermStats.auto100Completed === true, reward: 300 },
                
                { id: 'a20_fast_flip_1', icon: 'â±ï¸', title: 'HÄ±zcÄ±', desc: 'AtÄ±ÅŸ HÄ±zÄ± yÃ¼kseltmesini 2. seviyeye yÃ¼kseltin.', check: (s) => s.flipSpeedLevel >= 2, reward: 200 },
                { id: 'a21_fast_flip_max', icon: 'ğŸš€', title: 'IÅŸÄ±k HÄ±zÄ±', desc: 'AtÄ±ÅŸ HÄ±zÄ± yÃ¼kseltmesini maksimum seviyeye (4) yÃ¼kseltin.', check: (s) => s.flipSpeedLevel >= 4, reward: 1000 },
                { id: 'a22_category_mode', icon: 'ğŸ“š', title: 'Kategorist', desc: 'Kategori Modunda 50 kez atÄ±ÅŸ yapÄ±n.', check: (s) => s.longTermStats.modePlays && s.longTermStats.modePlays['CATEGORY'] >= 50, reward: 150 },
                { id: 'a23_total_flips_10k', icon: 'â™¾ï¸', title: 'On Binli', desc: 'Toplam 10.000 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 10000, reward: 2000 },
                { id: 'a24_streak_15', icon: 'â˜¢ï¸', title: 'Kritik Seri', desc: 'AynÄ± sonuca 15 kez Ã¼st Ã¼ste ulaÅŸÄ±n.', check: (s) => s.bestStreak >= 15, reward: 1500 },
                { id: 'a25_all_achievements', icon: 'ğŸ¥‡', title: 'Mutlak Usta', desc: 'TÃ¼m baÅŸarÄ±mlarÄ± tamamlayÄ±n.', check: (s) => s.unlockedAchievements.length === Game.achievements.length, reward: 10000 },

                { id: 'a26_lucky_win', icon: 'ğŸ€', title: 'Talih KuÅŸu', desc: 'Åans EtkinliÄŸi (Lucky Flip) ile ilk bÃ¼yÃ¼k Ã¶dÃ¼lÃ¼nÃ¼zÃ¼ kazanÄ±n.', check: (s) => s.longTermStats.luckyFlipsWon >= 1, reward: 500 },
                { id: 'a27_richer_boy', icon: 'ğŸ’°ğŸ’°', title: 'Milyoner', desc: '50.000 Jeton biriktirin (anlÄ±k jeton).', check: (s) => s.currency >= 50000, reward: 5000 },
                { id: 'a28_long_session', icon: 'â³', title: 'Maratoncu', desc: 'Toplam 25.000 atÄ±ÅŸ yapÄ±n.', check: (s) => s.total >= 25000, reward: 4000 }
            ],

            audio: {
                ctx: null,
                init: function() {
                    if (!this.ctx) {
                        window.AudioContext = window.AudioContext || window.webkitAudioContext;
                        this.ctx = new AudioContext();
                    }
                    if (this.ctx.state === 'suspended') {
                        this.ctx.resume();
                    }
                },
                playTone: function(type) {
                    this.init();
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.connect(gain);
                    gain.connect(this.ctx.destination);

                    const now = this.ctx.currentTime;
                    
                    if (type === 'flip') {
                        osc.type = 'triangle';
                        osc.frequency.setValueAtTime(150, now);
                        osc.frequency.exponentialRampToValueAtTime(600, now + 0.1);
                        gain.gain.setValueAtTime(0.1, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                        osc.start(now);
                        osc.stop(now + 0.1);
                    } else if (type === 'win') {
                        osc.type = 'sine';
                        osc.frequency.setValueAtTime(500, now);
                        osc.frequency.exponentialRampToValueAtTime(1000, now + 0.1);
                        gain.gain.setValueAtTime(0.2, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                        osc.start(now);
                        osc.stop(now + 0.3);
                    } else if (type === 'record') {
                        this.playTone('win');
                        setTimeout(() => this.playTone('win'), 100);
                    }
                }
            },

            data: {
                load: function() {
                    const saved = localStorage.getItem('CF_V2000_DATA'); 
                    const theme = localStorage.getItem('CF_V11_THEME');
                    
                    if (theme === 'dark') document.body.classList.add('dark-mode');

                    if (saved) {
                        const parsed = JSON.parse(saved);
                        
                        Game.state = { 
                            ...Game.state, 
                            ...parsed, 
                            longTermStats: { 
                                ...Game.state.longTermStats, 
                                ...parsed.longTermStats,
                                modePlays: parsed.longTermStats ? (parsed.longTermStats.modePlays || {}) : {} 
                            },
                            flipBonusLevel: parsed.flipBonusLevel || 1, 
                            flipSpeedLevel: parsed.flipSpeedLevel || 1, 
                            luckyBonusLevel: parsed.luckyBonusLevel || 1, 
                            weightedConfig: parsed.weightedConfig || Game.state.weightedConfig,
                            customOutcomes: parsed.customOutcomes || Game.state.customOutcomes
                        };
                        
                        // Ã–zel modu defaults'a yÃ¼kle
                        if (Game.state.customOutcomes.length > 0) {
                            Game.defaults['CUSTOM'] = Game.state.customOutcomes;
                        }

                        // YÃ¼kseltmeleri hesapla
                        Game.state.flipBonus = Game.upgrades.flipBonus.effect(Game.state.flipBonusLevel);
                        Game.state.flipDuration = Game.upgrades.flipSpeed.effect(Game.state.flipSpeedLevel);
                        Game.ui.updateFlipSpeed();

                        Object.keys(Game.skins).forEach(key => {
                            if (Game.state.inventory.includes(key)) {
                                Game.skins[key].unlocked = true;
                            }
                        });

                        if (Game.state.weightedConfig.length === 0) {
                             Game.state.weightedConfig = JSON.parse(JSON.stringify(Game.defaults['NORMAL']));
                        }
                        
                        // Mod ayarÄ±nÄ± yap
                        let targetOutcomes = Game.defaults[Game.state.mode] || Game.defaults.NORMAL;
                        if (Game.state.mode === 'WEIGHTED') {
                             targetOutcomes = Game.state.weightedConfig;
                        } else if (Game.state.mode === 'CUSTOM') {
                            targetOutcomes = Game.state.customOutcomes.length > 0 ? Game.state.customOutcomes : Game.defaults.NORMAL;
                        }

                        // Mevcut istatistikleri koruyarak Ã§Ä±ktÄ±larÄ± ayarla
                        Game.state.outcomes = targetOutcomes.map(def => {
                            const existing = parsed.outcomes ? parsed.outcomes.find(o => o.id === def.id) : null;
                            return { ...def, count: existing ? existing.count : 0 };
                        });
                        
                    } else {
                        Game.logic.setMode('NORMAL');
                    }
                    Game.ui.render();
                },
                save: function() {
                    localStorage.setItem('CF_V2000_DATA', JSON.stringify(Game.state));
                },
                exportData: function() {
                    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(Game.state));
                    const node = document.createElement('a');
                    node.setAttribute("href", dataStr);
                    node.setAttribute("download", "coin_flip_V3250_backup.json");
                    document.body.appendChild(node);
                    node.click();
                    node.remove();
                },
                importData: function(input) {
                    const file = input.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            Game.state = { ...Game.state, ...data };
                            Game.data.save();
                            location.reload();
                        } catch(err) { alert("Dosya hatalÄ±!"); }
                    };
                    reader.readAsText(file);
                }
            },

            logic: {
                setMode: function(modeName) {
                    if (Game.state.isAuto) return alert("Otomatik atÄ±ÅŸ sÄ±rasÄ±nda mod deÄŸiÅŸtirilemez.");
                    
                    Game.state.mode = modeName;
                    
                    if (modeName === 'WEIGHTED') {
                        Game.state.outcomes = JSON.parse(JSON.stringify(Game.state.weightedConfig));
                    } else if (modeName === 'CUSTOM') {
                         if (Game.state.customOutcomes.length === 0) {
                            alert("Ã–zel mod ayarlanmamÄ±ÅŸ. VarsayÄ±lan moda dÃ¶nÃ¼lÃ¼yor.");
                            Game.logic.setMode('NORMAL');
                            return;
                         }
                         Game.state.outcomes = JSON.parse(JSON.stringify(Game.state.customOutcomes));
                    } else if (Game.defaults[modeName]) {
                        Game.state.outcomes = JSON.parse(JSON.stringify(Game.defaults[modeName]));
                    } else {
                        Game.logic.setMode('NORMAL');
                        return;
                    }
                    
                    Game.state.outcomes.forEach(o => o.count = 0);
                    Game.state.total = 0;
                    Game.state.streak = 0;
                    Game.state.lastId = null;
                    
                    Game.ui.initializeCoinVisuals(modeName);
                    
                    Game.data.save();
                    Game.ui.render();
                    Game.ui.toggleMenu(false); 
                },

                getWeightedResult: function() {
                    const totalWeight = Game.state.outcomes.reduce((sum, o) => sum + o.weight, 0);
                    let rand = Math.random() * totalWeight;

                    for (const outcome of Game.state.outcomes) {
                        if (rand < outcome.weight) {
                            return outcome;
                        }
                        rand -= outcome.weight;
                    }
                    return Game.state.outcomes[Game.state.outcomes.length - 1];
                },

                flip: function() {
                    const coinEl = document.getElementById('coin');
                    if (coinEl.classList.contains('is-flipping')) return;

                    Game.audio.playTone('flip');

                    coinEl.textContent = '...';
                    coinEl.classList.add('is-flipping');
                    document.getElementById('result-text').textContent = "DÃ¶nÃ¼yor...";
                    
                    if (!Game.state.isAuto) Game.ui.setControls(false); 

                    let winner;
                    if (Game.state.mode === 'WEIGHTED' || Game.state.mode === 'CUSTOM') {
                        winner = Game.logic.getWeightedResult(); 
                    } else {
                        const winnerIndex = Math.floor(Math.random() * Game.state.outcomes.length);
                        winner = Game.state.outcomes[winnerIndex];
                    }

                    setTimeout(() => {
                        coinEl.classList.remove('is-flipping');
                        
                        // Ä°statistikleri gÃ¼ncelle
                        const winnerIndex = Game.state.outcomes.findIndex(o => o.id === winner.id);
                        if(winnerIndex !== -1) Game.state.outcomes[winnerIndex].count++;
                        Game.state.total++;
                        
                        Game.state.longTermStats.modePlays = Game.state.longTermStats.modePlays || {};
                        Game.state.longTermStats.modePlays[Game.state.mode] = (Game.state.longTermStats.modePlays[Game.state.mode] || 0) + 1;
                        
                        // --- ÅANS ETKÄ°NLÄ°ÄÄ° KONTROLÃœ VE JETON KAZANIMI ---
                        let currencyGain = 1 * Game.state.flipBonus; 
                        let luckyBonus = 0;

                        // %5 Åans EtkinliÄŸi KontrolÃ¼
                        if (Math.random() < 0.05) { 
                            
                            const calculatedLuckyReward = Game.upgrades.luckyBonus.effect(Game.state.luckyBonusLevel); 
                            const baseLuckyReward = 4;

                            currencyGain = baseLuckyReward * Game.state.flipBonus; 
                            luckyBonus = calculatedLuckyReward;

                            Game.state.currency += luckyBonus; 
                            Game.state.longTermStats.totalCurrencyEarned += luckyBonus;
                            Game.state.longTermStats.luckyFlipsWon++; 

                            document.getElementById('flip-message').style.backgroundColor = 'var(--accent)';
                            document.getElementById('flip-message').textContent = `ğŸ’¥ ÅANS ETKÄ°NLÄ°ÄÄ°! +${currencyGain} Jeton (x${Game.state.flipBonus}) + ${luckyBonus} Ekstra Jeton!`;
                        } else {
                            // Normal Jeton KazanÄ±mÄ±
                            document.getElementById('flip-message').style.backgroundColor = 'transparent';
                            document.getElementById('flip-message').textContent = `+${currencyGain} Jeton KazanÄ±ldÄ±! (x${Game.state.flipBonus})`;
                        }

                        // Toplam Jetonu ve Ä°statistikleri GÃ¼ncelle
                        Game.state.currency += currencyGain;
                        Game.state.longTermStats.totalCurrencyEarned += currencyGain;
                        
                        document.getElementById('flip-message').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('flip-message').style.display = 'none';
                            document.getElementById('flip-message').style.backgroundColor = 'transparent'; // Reset
                        }, Game.state.flipDuration * 1000 + 50);

                        // SERÄ° MANTIK
                        if (Game.state.lastId === winner.id) {
                            Game.state.streak++;
                            Game.state.longTermStats.totalFlipWins++; 
                        } else {
                            Game.state.streak = 1;
                            Game.state.longTermStats.totalFlipLosses++; 
                        }
                        Game.state.lastId = winner.id; 

                        let isRecord = false;
                        if (Game.state.streak > Game.state.bestStreak) {
                            Game.state.bestStreak = Game.state.streak;
                            isRecord = true;
                        }

                        Game.ui.updateResult(winner, isRecord);
                        Game.ui.renderStats(); 
                        Game.logic.checkAchievements();
                        Game.data.save();

                        Game.audio.playTone(isRecord ? 'record' : 'win');
                        Game.ui.fireConfetti(winner.color);
                        Game.ui.renderHeader(); 

                        // OTOMATÄ°K KONTROL
                        if (Game.state.isAuto) {
                            Game.state.autoCount++; 
                            
                            if (Game.state.autoLimit === 999999 && Game.state.autoCount === 100) {
                                Game.state.longTermStats.auto100Completed = true; 
                            } else if (Game.state.autoCount >= Game.state.autoLimit) {
                                Game.logic.toggleAuto(); 
                                document.getElementById('result-text').textContent = `${Game.state.autoCount} AtÄ±ÅŸ TamamlandÄ±!`;
                                Game.logic.checkAchievements(); 
                            } 
                        } else {
                            Game.ui.setControls(true);
                        }

                    }, Game.state.flipDuration * 1000); 
                },

                toggleAuto: function() {
                    const btn = document.getElementById('btn-auto');
                    const limitSelect = document.getElementById('auto-limit');

                    if (Game.state.isAuto) {
                        Game.state.isAuto = false;
                        clearInterval(Game.autoInterval); 
                        btn.textContent = 'ğŸš€ Otomatik';
                        btn.classList.replace('btn-primary', 'btn-secondary');
                        Game.ui.setControls(true);
                        limitSelect.disabled = false;
                    } else {
                        Game.state.isAuto = true;
                        Game.state.autoLimit = parseInt(limitSelect.value);
                        Game.state.autoCount = 0;
                        
                        btn.textContent = 'ğŸ›‘ Durdur';
                        btn.classList.replace('btn-secondary', 'btn-primary');
                        Game.ui.setControls(false); 
                        limitSelect.disabled = true;

                        Game.logic.flip();
                        
                        Game.autoInterval = setInterval(() => {
                            if (!document.getElementById('coin').classList.contains('is-flipping') && Game.state.isAuto) {
                                Game.logic.flip();
                            } else if (!Game.state.isAuto) {
                                clearInterval(Game.autoInterval);
                            }
                        }, Game.state.flipDuration * 1000 + 50); 
                    }
                },

                resetStats: function() {
                    if (confirm('TÃ¼m istatistikleri sÄ±fÄ±rlamak istiyor musunuz? (Jetonlar ve YÃ¼kseltmeler korunur)')) {
                        Game.state.outcomes.forEach(o => o.count = 0);
                        Game.state.total = 0;
                        Game.state.streak = 0;
                        Game.state.bestStreak = 0;
                        Game.state.lastId = null;
                        Game.data.save();
                        Game.ui.render();
                    }
                },

                checkAchievements: function() {
                    let changed = false;
                    Game.achievements.forEach(ach => {
                        if (!Game.state.unlockedAchievements.includes(ach.id) && ach.check(Game.state)) {
                            Game.state.unlockedAchievements.push(ach.id);
                            
                            Game.state.currency += ach.reward || 0;
                            Game.state.longTermStats.totalCurrencyEarned += ach.reward || 0;

                            Game.ui.renderHeader(); 
                            alert(`ğŸ† BAÅARIM AÃ‡ILDI: ${ach.title} (ğŸ’° ${ach.reward} Jeton)`); 
                            changed = true;
                        }
                    });
                    if(changed) Game.ui.renderAchievements();
                },
                
                // âœï¸ Ã–ZEL MODU KAYDETME VE BAÅLATMA
                saveCustomMode: function() {
                    const inputs = document.querySelectorAll('#custom-inputs > .input-group');
                    if (inputs.length < 2) {
                        alert("En az 2 sonuÃ§ tanÄ±mlamalÄ±sÄ±nÄ±z.");
                        return;
                    }
                    
                    const newOutcomes = [];
                    let hasError = false;
                    
                    inputs.forEach((group, index) => {
                        const name = group.querySelector(`#custom-name-${index}`).value.trim();
                        const emoji = group.querySelector(`#custom-emoji-${index}`).value.trim() || 'â“';
                        const color = group.querySelector(`#custom-color-${index}`).value;
                        
                        if (name === "") {
                            alert("TÃ¼m sonuÃ§lara isim vermelisiniz.");
                            hasError = true;
                            return;
                        }
                        
                        newOutcomes.push({
                            id: 'c' + (index + 1),
                            name: name,
                            emoji: emoji,
                            color: color,
                            count: 0,
                            weight: 100 / inputs.length
                        });
                    });
                    
                    if (hasError) return;

                    Game.state.customOutcomes = newOutcomes;
                    Game.defaults['CUSTOM'] = newOutcomes;
                    
                    Game.data.save();
                    document.getElementById('custom-modal').classList.remove('open');
                    Game.logic.setMode('CUSTOM');
                },

                // âš–ï¸ AÄIRLIKLI MODU KAYDETME VE BAÅLATMA
                saveWeightedConfig: function() {
                    const inputs = document.querySelectorAll('#weighted-inputs input[type="number"]');
                    let total = 0;
                    
                    inputs.forEach(input => {
                        total += parseFloat(input.value) || 0;
                    });

                    if (Math.abs(total - 100) > 0.01) {
                        alert(`Hata: Toplam aÄŸÄ±rlÄ±k tam 100% olmalÄ±dÄ±r! Åu an: ${total.toFixed(2)}%`);
                        return;
                    }
                    
                    Game.state.weightedConfig = Game.state.weightedConfig.map((o, index) => {
                        o.weight = parseFloat(inputs[index].value);
                        return o;
                    });
                    
                    Game.data.save();
                    document.getElementById('weighted-modal').classList.remove('open');
                    Game.logic.setMode('WEIGHTED');
                }
            },

            shop: {
                buyUpgrade: function(upgradeId) {
                    const upgrade = Game.upgrades[upgradeId];
                    let currentLevel = 0;

                    if (upgradeId === 'flipBonus') {
                        currentLevel = Game.state.flipBonusLevel;
                    } else if (upgradeId === 'flipSpeed') {
                        currentLevel = Game.state.flipSpeedLevel;
                    } else if (upgradeId === 'luckyBonus') {
                        currentLevel = Game.state.luckyBonusLevel;
                    }

                    if (currentLevel >= upgrade.maxLevel) {
                        alert("Bu yÃ¼kseltme zaten maksimum seviyede.");
                        return;
                    }

                    const cost = Math.ceil(upgrade.baseCost * Math.pow(upgrade.costMultiplier, currentLevel));
                    
                    if (Game.state.currency >= cost) {
                        Game.state.currency -= cost;
                        
                        if (upgradeId === 'flipBonus') {
                            Game.state.flipBonusLevel++;
                            Game.state.flipBonus = upgrade.effect(Game.state.flipBonusLevel);
                        } else if (upgradeId === 'flipSpeed') {
                            Game.state.flipSpeedLevel++;
                            Game.state.flipDuration = upgrade.effect(Game.state.flipSpeedLevel);
                            Game.ui.updateFlipSpeed(); 
                        } else if (upgradeId === 'luckyBonus') {
                            Game.state.luckyBonusLevel++;
                        }
                        
                        Game.data.save();
                        Game.ui.renderHeader();
                        Game.shop.renderShop();
                        Game.logic.checkAchievements();
                        alert(`${upgrade.name} seviye ${currentLevel + 1} baÅŸarÄ±yla satÄ±n alÄ±ndÄ±!`);
                    } else {
                        alert(`Yeterli Jeton yok! ${cost - Game.state.currency} Jeton daha lazÄ±m.`);
                    }
                },

                buySkin: function(skinId) {
                    const skin = Game.skins[skinId];
                    if (Game.state.inventory.includes(skinId)) {
                        Game.shop.equipSkin(skinId);
                        return;
                    }

                    if (Game.state.currency >= skin.price) {
                        if (confirm(`${skin.name} (${skin.emoji}) kozmetiÄŸini ${skin.price} jeton karÅŸÄ±lÄ±ÄŸÄ±nda satÄ±n almak istiyor musunuz?`)) {
                            Game.state.currency -= skin.price;
                            Game.state.inventory.push(skinId);
                            skin.unlocked = true;
                            Game.shop.equipSkin(skinId);
                            Game.data.save();
                            Game.ui.renderHeader();
                            Game.shop.renderShop();
                            Game.logic.checkAchievements();
                        }
                    } else {
                        alert(`Yeterli Jeton yok! ${skin.price - Game.state.currency} Jeton daha lazÄ±m.`);
                    }
                },
                
                equipSkin: function(skinId) {
                    Game.state.activeSkin = skinId;
                    Game.data.save();
                    Game.shop.renderShop();
                    Game.ui.initializeCoinVisuals(Game.state.mode);
                    alert(`${Game.skins[skinId].name} donatÄ±ldÄ±.`);
                },

                renderShop: function() {
                    const currencyDisplay = document.getElementById('shop-currency-display');
                    currencyDisplay.textContent = `Mevcut Jeton: ğŸ’° ${Game.state.currency}`;
                    Game.shop.renderUpgrades();
                    Game.shop.renderSkins();
                },

                renderUpgrades: function() {
                    const container = document.getElementById('upgrade-section');
                    container.innerHTML = '';
                    
                    Object.keys(Game.upgrades).forEach(upgradeId => {
                        const upgrade = Game.upgrades[upgradeId];
                        
                        let currentLevel = 0;
                        if (upgradeId === 'flipBonus') currentLevel = Game.state.flipBonusLevel;
                        else if (upgradeId === 'flipSpeed') currentLevel = Game.state.flipSpeedLevel;
                        else if (upgradeId === 'luckyBonus') currentLevel = Game.state.luckyBonusLevel;
                        
                        let cost;
                        const maxed = currentLevel >= upgrade.maxLevel;
                        
                        if (maxed) {
                            cost = 0;
                        } else {
                             cost = Math.ceil(upgrade.baseCost * Math.pow(upgrade.costMultiplier, currentLevel)); 
                        }

                        const descText = upgrade.desc(currentLevel); 
                        
                        const buttonHTML = maxed 
                            ? `<button class="btn btn-secondary" disabled>Max Seviye</button>`
                            : `<button class="btn btn-primary" onclick="Game.shop.buyUpgrade('${upgradeId}')">ğŸ’° ${cost}</button>`;

                        container.innerHTML += `
                            <div class="upgrade-card">
                                <div class="upgrade-info">
                                    <div>
                                        <h4>${upgrade.icon} ${upgrade.name}</h4>
                                        <p class="upgrade-desc">${descText}</p>
                                    </div>
                                    <div class="upgrade-level">
                                        Seviye: ${currentLevel} / ${upgrade.maxLevel}
                                    </div>
                                </div>
                                ${buttonHTML}
                            </div>
                        `;
                    });
                },

                renderSkins: function() {
                    const container = document.getElementById('shop-items-grid');
                    container.innerHTML = '';

                    Object.keys(Game.skins).forEach(skinId => {
                        const skin = Game.skins[skinId];
                        const isUnlocked = Game.state.inventory.includes(skinId);
                        const isEquipped = Game.state.activeSkin === skinId;
                        
                        let buttonHTML;
                        if (isEquipped) {
                            buttonHTML = `<button class="btn btn-primary" disabled>DonatÄ±ldÄ±</button>`;
                        } else if (isUnlocked) {
                            buttonHTML = `<button class="btn btn-secondary" onclick="Game.shop.equipSkin('${skinId}')">Donat</button>`;
                        } else {
                            buttonHTML = `<button class="btn btn-primary" onclick="Game.shop.buySkin('${skinId}')">ğŸ’° ${skin.price}</button>`;
                        }

                        container.innerHTML += `
                            <div class="shop-item ${isEquipped ? 'equipped' : ''}" style="border: 2px solid ${isEquipped ? 'var(--accent)' : 'transparent'}">
                                <span class="shop-item-icon">${skin.emoji}</span>
                                <h4>${skin.name}</h4>
                                ${isUnlocked ? '<p style="color:var(--accent); font-weight:700;">AÃ§Ä±k</p>' : `<p class="shop-price">ğŸ’° ${skin.price}</p>`}
                                ${buttonHTML}
                            </div>
                        `;
                    });
                }
            },

            analyst: {
                calculatePrediction: function() {
                    // Bu kÄ±sÄ±m kompleks tahminler iÃ§erebilir, ÅŸimdilik basit tutalÄ±m.
                    let totalFlips = Game.state.outcomes.reduce((sum, o) => sum + o.count, 0);
                    if (totalFlips < 20) return "Analist: Yeterli veri yok. AtÄ±ÅŸ yapmaya devam edin.";

                    let lowestOutcome = Game.state.outcomes.reduce((min, o) => o.count < min.count ? o : min, { count: Infinity });
                    let highestOutcome = Game.state.outcomes.reduce((max, o) => o.count > max.count ? o : max, { count: -Infinity });

                    if (highestOutcome.count - lowestOutcome.count > totalFlips * 0.1) {
                         return `Analist: Ä°statistiksel sapma var! Bir sonraki atÄ±ÅŸÄ±nÄ±zÄ±n **${lowestOutcome.name} (${lowestOutcome.emoji})** gelme olasÄ±lÄ±ÄŸÄ± istatistiksel olarak daha yÃ¼ksektir.`;
                    } else {
                         return "Analist: Ä°statistikler dengede gÃ¶rÃ¼nÃ¼yor. AtÄ±ÅŸÄ±nÄ±z %50 ÅŸansla devam edecektir. ÅansÄ±nÄ±z bol olsun!";
                    }
                },

                renderAnalyst: function() {
                    const luckyExtra = Game.upgrades.luckyBonus.effect(Game.state.luckyBonusLevel);
                    const longStats = document.getElementById('analyst-long-stats');
                    longStats.innerHTML = `
                        <div class="stat-row"><span>Toplam KazanÄ±lan Jeton:</span> <span>ğŸ’° ${Game.state.longTermStats.totalCurrencyEarned}</span></div>
                        <div class="stat-row"><span>Mevcut Jeton Ã‡arpanÄ±:</span> <span>x${Game.state.flipBonus}</span></div>
                        <div class="stat-row"><span>Åans EtkinliÄŸi Ekstra:</span> <span>ğŸ’° ${luckyExtra}</span></div>
                        <div class="stat-row"><span>AtÄ±ÅŸ HÄ±zÄ± SÃ¼resi:</span> <span>${Game.state.flipDuration}s</span></div>
                        <div class="stat-row"><span>Toplam BaÅŸarÄ±mlar:</span> <span>ğŸ† ${Game.state.unlockedAchievements.length} / ${Game.achievements.length}</span></div>
                    `;
                    
                    document.getElementById('analyst-prediction').textContent = Game.analyst.calculatePrediction();
                }
            },

            ui: {
                renderHeader: function() {
                    document.getElementById('currency-display').textContent = `ğŸ’° ${Game.state.currency}`;
                },
                
                updateFlipSpeed: function() {
                    const body = document.getElementById('game-body');
                    body.style.setProperty('--flip-duration', `${Game.state.flipDuration}s`);
                },

                toggleMenu: function(forceState) {
                    const modal = document.getElementById('main-menu-modal');
                    if (forceState === false) modal.classList.remove('open');
                    else modal.classList.toggle('open');
                },
                
                renderStats: function() {
                    const container = document.getElementById('stats-container');
                    const totalFlipsEl = document.getElementById('total-flips');
                    const bestStreakEl = document.getElementById('best-streak');
                    const modeNameEl = document.getElementById('mode-name-display');

                    container.innerHTML = '';
                    
                    modeNameEl.textContent = Game.state.mode === 'NORMAL' ? 'Normal' : 
                                             Game.state.mode === 'WEIGHTED' ? 'AÄŸÄ±rlÄ±klÄ±' :
                                             Game.state.mode === 'CUSTOM' ? 'Ã–zel' :
                                             Game.state.mode === 'RPS' ? 'TaÅŸ-KaÄŸÄ±t-Makas' :
                                             Game.state.mode === 'DICE' ? 'Zar' :
                                             Game.state.mode === 'SIMPLE' ? 'Basit' :
                                             Game.state.mode === 'CATEGORY' ? 'Kategori' : Game.state.mode;

                    if (Game.state.total === 0) {
                        container.innerHTML = `<p style="text-align:center; color:var(--text-muted);">HenÃ¼z atÄ±ÅŸ yapÄ±lmadÄ±. Ä°statistikler burada gÃ¶rÃ¼necek.</p>`;
                        totalFlipsEl.textContent = 0;
                        bestStreakEl.textContent = 0;
                        return;
                    }

                    Game.state.outcomes.forEach(o => {
                        const percent = Game.state.total > 0 ? ((o.count / Game.state.total) * 100).toFixed(1) : 0;
                        const statRow = document.createElement('div');
                        statRow.className = 'stat-row';
                        statRow.innerHTML = `
                            <span>${o.emoji} ${o.name} (${o.count})</span>
                            <div class="stat-bar-wrapper">
                                <div class="stat-bar" style="width: ${percent}%; background-color: ${o.color};"></div>
                            </div>
                            <span>${percent}%</span>
                        `;
                        container.appendChild(statRow);
                    });

                    totalFlipsEl.textContent = Game.state.total;
                    bestStreakEl.textContent = Game.state.bestStreak;
                },

                setControls: function(enabled) {
                    document.getElementById('btn-flip').disabled = !enabled;
                    document.getElementById('btn-reset').disabled = !enabled;
                },
                
                openShopModal: function() {
                    Game.shop.renderShop();
                    document.getElementById('shop-modal').classList.add('open');
                },
                openAnalystModal: function() {
                    Game.analyst.renderAnalyst();
                    document.getElementById('analyst-modal').classList.add('open');
                },
                
                initializeCoinVisuals: function(modeName) {
                    const coinEl = document.getElementById('coin');
                    const currentSkinId = Game.state.activeSkin;
                    const skin = Game.skins[currentSkinId];
                    
                    if (currentSkinId === 'default' && Game.defaults[modeName]) {
                        coinEl.style.background = Game.skins['default'].background;
                        coinEl.style.color = Game.skins['default'].color;
                        coinEl.textContent = Game.skins['default'].emoji;
                    } else if (skin) {
                         coinEl.style.background = skin.background;
                         coinEl.style.color = skin.color;
                         coinEl.textContent = skin.emoji; 
                    }
                    
                    document.getElementById('result-text').textContent = "AtÄ±ÅŸ Yapmaya HazÄ±r!";
                    const streakBadge = document.getElementById('streak-badge');
                    streakBadge.style.display = 'none';
                },
                
                updateResult: function(winner, isRecord) {
                    const coinEl = document.getElementById('coin');
                    let skin = Game.skins[Game.state.activeSkin];
                    
                    if (Game.state.activeSkin === 'default') {
                        coinEl.style.background = winner.color;
                        coinEl.style.color = '#fff'; 
                        coinEl.textContent = winner.emoji;

                    } else if (skin) {
                         coinEl.style.background = skin.background;
                         coinEl.style.color = skin.color;
                         coinEl.textContent = winner.emoji || skin.emoji; 
                    } 
                    
                    document.getElementById('result-text').textContent = `${winner.name} Geldi!`;

                    const streakBadge = document.getElementById('streak-badge');
                    if (Game.state.streak > 1) {
                        streakBadge.style.display = 'flex';
                        streakBadge.textContent = `ğŸ”¥ ${Game.state.streak}`;
                        document.getElementById('result-text').textContent += ` (${Game.state.streak} Seri!)`;
                    } else {
                         streakBadge.style.display = 'none';
                    }
                    
                    if (isRecord) {
                        document.getElementById('result-text').textContent += ` - YENÄ° REKOR!`;
                    }
                },


                renderAchievements: function() {
                    const container = document.getElementById('achievements-list');
                    container.innerHTML = '';
                    Game.achievements.forEach(ach => {
                        const isUnlocked = Game.state.unlockedAchievements.includes(ach.id);
                        container.innerHTML += `
                            <div class="achievement-item ${isUnlocked ? 'unlocked' : ''}" 
                                onclick="Game.ui.openAchInfoModal('${ach.id}')">
                                <span class="ach-icon">${ach.icon}</span>
                            </div>
                        `;
                    });
                },

                openAchInfoModal: function(achId) {
                    const ach = Game.achievements.find(a => a.id === achId);
                    const isUnlocked = Game.state.unlockedAchievements.includes(achId);
                    
                    document.getElementById('ach-title').textContent = ach.icon + " " + ach.title;
                    document.getElementById('ach-desc').textContent = ach.desc;
                    
                    if (isUnlocked) {
                        document.getElementById('ach-reward').textContent = `âœ… BaÅŸarÄ±mÄ± AÃ§tÄ±nÄ±z! KazanÄ±lan Ã–dÃ¼l: ğŸ’° ${ach.reward}`;
                        document.getElementById('ach-reward').style.color = 'var(--accent)';
                        document.getElementById('ach-status').textContent = 'Oyun kayÄ±tlarÄ±nÄ±zda bulunmaktadÄ±r.';
                    } else {
                        document.getElementById('ach-reward').textContent = `Ã–dÃ¼l: ğŸ’° ${ach.reward} Jeton`;
                        document.getElementById('ach-reward').style.color = 'var(--warning)';
                        document.getElementById('ach-status').textContent = 'Kilidi aÃ§mak iÃ§in gereklilikleri tamamlayÄ±n.';
                    }

                    document.getElementById('ach-info-modal').classList.add('open');
                },
                
                // âš–ï¸ AÄIRLIKLI MOD MODALINI AÃ‡
                openWeightedModal: function() {
                    const container = document.getElementById('weighted-inputs');
                    container.innerHTML = '';
                    
                    if (Game.state.weightedConfig.length === 0) {
                        Game.state.weightedConfig = JSON.parse(JSON.stringify(Game.defaults['NORMAL']));
                    }
                    
                    let totalWeight = 0;

                    Game.state.weightedConfig.forEach((o, index) => {
                        totalWeight += o.weight;
                        container.innerHTML += `
                            <div class="input-group">
                                <span class="input-emoji">${o.emoji}</span>
                                <input type="text" value="${o.name}" class="input-text" disabled style="flex:1;">
                                <input type="number" id="weight-${index}" class="input-text" value="${o.weight.toFixed(2)}" min="0" max="100" step="0.01" style="width: 80px;" oninput="Game.ui.updateWeightedTotal()">
                                <span style="width: 20px;">%</span>
                            </div>
                        `;
                    });
                    document.getElementById('weighted-total').textContent = `${totalWeight.toFixed(2)}%`;
                    Game.ui.updateWeightedTotal(); 
                    document.getElementById('weighted-modal').classList.add('open');
                },
                
                // AÄIRLIK TOPLAMINI GÃœNCELLE
                updateWeightedTotal: function() {
                    const inputs = document.querySelectorAll('#weighted-inputs input[type="number"]');
                    let total = 0;
                    inputs.forEach(input => {
                        total += parseFloat(input.value) || 0;
                    });
                    const totalEl = document.getElementById('weighted-total');
                    const errorEl = document.getElementById('weighted-error');
                    
                    totalEl.textContent = `${total.toFixed(2)}%`;
                    if (Math.abs(total - 100) > 0.01) {
                        totalEl.style.color = 'var(--danger)';
                        errorEl.textContent = `Hata: Toplam aÄŸÄ±rlÄ±k 100% olmalÄ±. Fark: ${(total - 100).toFixed(2)}%`;
                    } else {
                        totalEl.style.color = 'var(--primary)';
                        errorEl.textContent = '';
                    }
                },
                
                // âœï¸ Ã–ZEL MOD MODALINI AÃ‡
                openCustomModal: function() {
                    const container = document.getElementById('custom-inputs');
                    container.innerHTML = '';
                    
                    // EÄŸer kaydedilmiÅŸ custom mod varsa onlarÄ± yÃ¼kle
                    if (Game.state.customOutcomes.length > 0) {
                        Game.state.customOutcomes.forEach((o, index) => {
                             Game.ui.addCustomInput(o.name, o.emoji, o.color);
                        });
                    } else {
                        // VarsayÄ±lan olarak 2 adet girdi ekle
                        Game.ui.addCustomInput('YazÄ±', 'âœï¸', '#ff7675');
                        Game.ui.addCustomInput('Tura', 'ğŸ‘‘', '#00b894');
                    }
                    document.getElementById('custom-modal').classList.add('open');
                },

                // Ã–ZEL MODA INPUT EKLE
                addCustomInput: function(name = '', emoji = 'â“', color = '#999999') {
                    const container = document.getElementById('custom-inputs');
                    if (container.children.length >= 5) {
                        alert("Maksimum 5 sonuÃ§ ekleyebilirsiniz.");
                        return;
                    }
                    
                    const index = container.children.length;

                    const newGroup = document.createElement('div');
                    newGroup.className = 'input-group';
                    newGroup.id = `custom-input-${index}`;
                    newGroup.innerHTML = `
                        <input type="text" placeholder="AdÄ±" value="${name}" id="custom-name-${index}" class="input-text" style="flex:2;">
                        <input type="text" placeholder="Emoji" value="${emoji}" id="custom-emoji-${index}" class="input-text input-emoji" maxlength="2" style="flex:0.5;">
                        <input type="color" value="${color}" id="custom-color-${index}" class="input-color">
                        <button onclick="document.getElementById('custom-input-${index}').remove()" class="icon-btn" style="color:var(--danger); font-size:1.2rem;">ğŸ—‘ï¸</button>
                    `;
                    container.appendChild(newGroup);
                },

                fireConfetti: function(color) {
                },


                render: function() {
                    Game.ui.renderStats();
                    Game.ui.renderAchievements();
                    Game.ui.renderHeader(); 
                    Game.ui.initializeCoinVisuals(Game.state.mode);
                    Game.ui.updateFlipSpeed();
                }

            }
        };

        // --- BAÅLATMA ---
        window.onload = function() {
            Game.data.load();
            
            document.body.addEventListener('click', function() {
                Game.audio.init();
            }, { once: true });
        };
    </script>
</body>
  </html>
